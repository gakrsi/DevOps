# Execute Changes to Infrastructure

### Purpose of the `ter`aform apply\` command <a href="#purpose-of-the-teraform-apply-command" id="purpose-of-the-teraform-apply-command"></a>

The `terraform apply` command executes changes to the actual environment to align it with the desired state expressed by the configuration or from the execution plan generated by `terraform plan`.

### Creation of an execution plan <a href="#creation-of-an-execution-plan" id="creation-of-an-execution-plan"></a>

By default, `terraform apply` looks for a Terraform configuration in the current working directory and creates an execution plan based on the desired state and the actual environment. The execution plan is presented to the user for approval. Once the user approves the execution plan, the changes are applied to the actual environment, and the state data is updated.

If a saved execution plan is submitted to `terraform apply`, it skips the execution plan generation and approval steps and moves directly to changing the actual environment and state data.

Strictly speaking, we don’t have to run `terraform plan` before `terraform apply`. Skipping the planning stage might be justified when running Terraform manually outside of a team setting. If we start to automate Terraform runs or collaborate with a team, then it’s advised to always run `terraform plan` first and save the execution plan to a file.

Execution flow

### Arguments <a href="#arguments" id="arguments"></a>

The `terraform apply` command has several arguments. The most commonly used ones are listed below:

* `-auto-approve` skips the approval step and automatically moves to make changes.
* `-input` determines whether to prompt for input and is set to `false` in automation.
* `-refresh` determines whether a refresh of state should be run and defaults to `true`.
* `-var` sets a value for a variable in the configuration and can be used multiple times.
* `-var-file` specifies a file that contains key/value pairs for variable values.

Several arguments are the same for `terraform plan` and `terraform apply`. That’s because `terraform apply` can be run without first running the plan. We can run the following command to submit the plan:

```bash
# copy-paste this command to submit the plan
terraform apply -auto-approve 
```

Having an execution plan is no guarantee that the changes will be applied successfully. Terraform will attempt to apply all changes, but things do occasionally go wrong. It might be a problem with the cloud provider or an unanticipated problem with ourconfiguration. When an error is encountered, Terraform doesn’t roll back to the previous configuration. It leaves resources as they are so we can attempt to troubleshoot the problem. Resources that weren’t successfully configured are marked as tainted, and Terraform will try to re-create them on the next run.

### Key takeaways <a href="#key-takeaways" id="key-takeaways"></a>

The `terraform apply` command makes the necessary changes to an actual environment to align it with the desired state expressed by a configuration. This command can generate an execution plan on its own and prompt for approval or take a saved execution plan and apply it.
